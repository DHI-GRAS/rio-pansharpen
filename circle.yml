machine:
  pre:
    - pyenv global 2.7 3.4 3.5

dependencies:
    pre:
        - sudo add-apt-repository -y ppa:ubuntugis/ppa
        - sudo apt-get update
        - sudo apt-get -y --no-install-recommends --force-yes install python-numpy libgdal1h gdal-bin libgdal-dev

    override:
        - pip install -U pip
        - pip install numpy
        - pip install -r requirements.txt
        - pip install -e ".[test]"

test:
    pre:
        - which python
        - v=$(python --version 2>& 1); if [ "$v" == "Python 2.7.11" ]; then echo "$v OK"; else ! echo "$v ERR"; fi
        - which python2
        - v=$(python2 --version 2>& 1); if [ "$v" == "Python 2.7.11" ]; then echo "$v OK"; else ! echo "$v ERR"; fi
        - which python3
        - v=$(python3 --version 2>& 1); if [ "$v" == "Python 3.5.1" ]; then echo "$v OK"; else ! echo "$v ERR"; fi

    override:
        - py.test --cov pansharpen --cov-report term-missing --ignore=venv
    post:
        - codecov

